var Module$1=(()=>{var e=import.meta.url;return function(n){var r,t;function l(e){if(!e)return 0;var n=function(e){for(var n=0,r=0;r<e.length;++r){var t=e.charCodeAt(r);t>=55296&&t<=57343&&(t=65536+((1023&t)<<10)|1023&e.charCodeAt(++r)),t<=127?++n:n+=t<=2047?2:t<=65535?3:4}return n}(e)+1,r=O(n);return M(e,r,n),r}(n=void 0!==(n=n||{})?n:{}).ready=new Promise((function(e,n){r=e,t=n}));var u=Object.assign({},n),o="";"undefined"!=typeof document&&document.currentScript&&(o=document.currentScript.src),e&&(o=e),o=0!==o.indexOf("blob:")?o.substr(0,o.replace(/[?#].*/,"").lastIndexOf("/")+1):"",console.log.bind(console);var a=console.warn.bind(console);Object.assign(n,u),u=null;var i,s,c=[];"object"!=typeof WebAssembly&&V("no native wasm support detected");var f=!1;var m,p,d,b,w,_,h="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function S(e,n){return e?function(e,n,r){for(var t=n+r,l=n;e[l]&&!(l>=t);)++l;if(l-n>16&&e.buffer&&h)return h.decode(e.subarray(n,l));for(var u="";n<l;){var o=e[n++];if(128&o){var a=63&e[n++];if(192!=(224&o)){var i=63&e[n++];if((o=224==(240&o)?(15&o)<<12|a<<6|i:(7&o)<<18|a<<12|i<<6|63&e[n++])<65536)u+=String.fromCharCode(o);else{var s=o-65536;u+=String.fromCharCode(55296|s>>10,56320|1023&s)}}else u+=String.fromCharCode((31&o)<<6|a)}else u+=String.fromCharCode(o)}return u}(d,e,n):""}function M(e,n,r){return function(e,n,r,t){if(!(t>0))return 0;for(var l=r,u=r+t-1,o=0;o<e.length;++o){var a=e.charCodeAt(o);if(a>=55296&&a<=57343&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o)),a<=127){if(r>=u)break;n[r++]=a}else if(a<=2047){if(r+1>=u)break;n[r++]=192|a>>6,n[r++]=128|63&a}else if(a<=65535){if(r+2>=u)break;n[r++]=224|a>>12,n[r++]=128|a>>6&63,n[r++]=128|63&a}else{if(r+3>=u)break;n[r++]=240|a>>18,n[r++]=128|a>>12&63,n[r++]=128|a>>6&63,n[r++]=128|63&a}}return n[r]=0,r-l}(e,d,n,r)}function g(e){m=e,n.HEAP8=p=new Int8Array(e),n.HEAP16=new Int16Array(e),n.HEAP32=b=new Int32Array(e),n.HEAPU8=d=new Uint8Array(e),n.HEAPU16=new Uint16Array(e),n.HEAPU32=new Uint32Array(e),n.HEAPF32=new Float32Array(e),n.HEAPF64=w=new Float64Array(e)}var y=[],v=[],F=[];var C=0,G=null;function V(e){a(e="Aborted("+e+")"),f=!0,e+=". Build with -s ASSERTIONS=1 for more info.";var n=new WebAssembly.RuntimeError(e);throw t(n),n}n.preloadedImages={},n.preloadedAudios={};var A;function E(e){return e.startsWith("data:application/octet-stream;base64,")}function N(e){try{throw"both async and sync fetching of the wasm failed"}catch(e){V(e)}}n.locateFile?E(A="wren.wasm")||(A=o+A):A=new URL("wren.wasm",import.meta.url).toString();var L={39316:function(e,r,t){return l(n._VMs[e]._resolveModule(S(r),S(t)))},39411:function(e,r){return l(n._VMs[e]._loadModule(S(r)))},39485:function(e,r,t,l,u){return n._VMs[e]._bindForeignMethod(S(r),S(t),1===l,S(u))},39599:function(e,r,t,l){return n._VMs[e]._bindForeignClass(S(r),S(t),l)},39688:function(e,r){n._VMs[e]._write(S(r))},39734:function(e,r,t,l,u){n._VMs[e]._error(r,S(t),l,S(u))}};function R(e){for(;e.length>0;){var r=e.shift();if("function"!=typeof r){var t=r.func;"number"==typeof t?void 0===r.arg?I(t)():I(t)(r.arg):t(void 0===r.arg?null:r.arg)}else r(n)}}var H=[];function I(e){var n=H[e];return n||(e>=H.length&&(H.length=e+1),H[e]=n=_.get(e)),n}function T(e,n){_.set(e,n),H[e]=n}var B=[];function W(e){try{return s.grow(e-m.byteLength+65535>>>16),g(s.buffer),1}catch(e){}}var U={b:function(){return Date.now()},a:function(e,n,r){var t=function(e,n){var r;for(B.length=0,n>>=2;r=d[e++];){var t=r<105;t&&1&n&&n++,B.push(t?w[n++>>1]:b[n]),++n}return B}(n,r);return L[e].apply(null,t)},d:function(e,n,r){d.copyWithin(e,n,n+r)},c:function(e){var n,r,t=d.length,l=2147483648;if((e>>>=0)>l)return!1;for(var u=1;u<=4;u*=2){var o=t*(1+.2/u);if(o=Math.min(o,e+100663296),W(Math.min(l,(n=Math.max(e,o))+((r=65536)-n%r)%r)))return!0}return!1}};!function(){var e={a:U};function r(e,r){var t,l=e.exports;n.asm=l,g((s=n.asm.e).buffer),_=n.asm.W,t=n.asm.f,v.unshift(t),function(e){if(0==--C&&G){var n=G;G=null,n()}}()}function l(e){r(e.instance)}function u(n){return("function"==typeof fetch?fetch(A,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+A+"'";return e.arrayBuffer()})).catch((function(){return N()})):Promise.resolve().then((function(){return N()}))).then((function(n){return WebAssembly.instantiate(n,e)})).then((function(e){return e})).then(n,(function(e){a("failed to asynchronously prepare wasm: "+e),V(e)}))}if(C++,n.instantiateWasm)try{return n.instantiateWasm(e,r)}catch(e){return a("Module.instantiateWasm callback failed with error: "+e),!1}("function"!=typeof WebAssembly.instantiateStreaming||E(A)||"function"!=typeof fetch?u(l):fetch(A,{credentials:"same-origin"}).then((function(n){return WebAssembly.instantiateStreaming(n,e).then(l,(function(e){return a("wasm streaming compile failed: "+e),a("falling back to ArrayBuffer instantiation"),u(l)}))}))).catch(t)}(),n.___wasm_call_ctors=function(){return(n.___wasm_call_ctors=n.asm.f).apply(null,arguments)},n._wrenCollectGarbage=function(){return(n._wrenCollectGarbage=n.asm.g).apply(null,arguments)},n._wrenInterpret=function(){return(n._wrenInterpret=n.asm.h).apply(null,arguments)},n._wrenGetVersionNumber=function(){return(n._wrenGetVersionNumber=n.asm.i).apply(null,arguments)},n._wrenInitConfiguration=function(){return(n._wrenInitConfiguration=n.asm.j).apply(null,arguments)},n._wrenNewVM=function(){return(n._wrenNewVM=n.asm.k).apply(null,arguments)},n._wrenFreeVM=function(){return(n._wrenFreeVM=n.asm.l).apply(null,arguments)},n._wrenMakeCallHandle=function(){return(n._wrenMakeCallHandle=n.asm.m).apply(null,arguments)},n._wrenCall=function(){return(n._wrenCall=n.asm.n).apply(null,arguments)},n._wrenReleaseHandle=function(){return(n._wrenReleaseHandle=n.asm.o).apply(null,arguments)},n._wrenGetSlotCount=function(){return(n._wrenGetSlotCount=n.asm.p).apply(null,arguments)},n._wrenEnsureSlots=function(){return(n._wrenEnsureSlots=n.asm.q).apply(null,arguments)},n._wrenGetSlotType=function(){return(n._wrenGetSlotType=n.asm.r).apply(null,arguments)},n._wrenGetSlotBool=function(){return(n._wrenGetSlotBool=n.asm.s).apply(null,arguments)},n._wrenGetSlotBytes=function(){return(n._wrenGetSlotBytes=n.asm.t).apply(null,arguments)},n._wrenGetSlotDouble=function(){return(n._wrenGetSlotDouble=n.asm.u).apply(null,arguments)},n._wrenGetSlotForeign=function(){return(n._wrenGetSlotForeign=n.asm.v).apply(null,arguments)},n._wrenGetSlotString=function(){return(n._wrenGetSlotString=n.asm.w).apply(null,arguments)},n._wrenGetSlotHandle=function(){return(n._wrenGetSlotHandle=n.asm.x).apply(null,arguments)},n._wrenSetSlotBool=function(){return(n._wrenSetSlotBool=n.asm.y).apply(null,arguments)},n._wrenSetSlotBytes=function(){return(n._wrenSetSlotBytes=n.asm.z).apply(null,arguments)},n._wrenSetSlotDouble=function(){return(n._wrenSetSlotDouble=n.asm.A).apply(null,arguments)},n._wrenSetSlotNewForeign=function(){return(n._wrenSetSlotNewForeign=n.asm.B).apply(null,arguments)},n._wrenSetSlotNewList=function(){return(n._wrenSetSlotNewList=n.asm.C).apply(null,arguments)},n._wrenSetSlotNewMap=function(){return(n._wrenSetSlotNewMap=n.asm.D).apply(null,arguments)},n._wrenSetSlotNull=function(){return(n._wrenSetSlotNull=n.asm.E).apply(null,arguments)},n._wrenSetSlotString=function(){return(n._wrenSetSlotString=n.asm.F).apply(null,arguments)},n._wrenSetSlotHandle=function(){return(n._wrenSetSlotHandle=n.asm.G).apply(null,arguments)},n._wrenGetListCount=function(){return(n._wrenGetListCount=n.asm.H).apply(null,arguments)},n._wrenGetListElement=function(){return(n._wrenGetListElement=n.asm.I).apply(null,arguments)},n._wrenSetListElement=function(){return(n._wrenSetListElement=n.asm.J).apply(null,arguments)},n._wrenInsertInList=function(){return(n._wrenInsertInList=n.asm.K).apply(null,arguments)},n._wrenGetMapCount=function(){return(n._wrenGetMapCount=n.asm.L).apply(null,arguments)},n._wrenGetMapContainsKey=function(){return(n._wrenGetMapContainsKey=n.asm.M).apply(null,arguments)},n._wrenGetMapValue=function(){return(n._wrenGetMapValue=n.asm.N).apply(null,arguments)},n._wrenSetMapValue=function(){return(n._wrenSetMapValue=n.asm.O).apply(null,arguments)},n._wrenRemoveMapValue=function(){return(n._wrenRemoveMapValue=n.asm.P).apply(null,arguments)},n._wrenGetVariable=function(){return(n._wrenGetVariable=n.asm.Q).apply(null,arguments)},n._wrenHasVariable=function(){return(n._wrenHasVariable=n.asm.R).apply(null,arguments)},n._wrenHasModule=function(){return(n._wrenHasModule=n.asm.S).apply(null,arguments)},n._wrenAbortFiber=function(){return(n._wrenAbortFiber=n.asm.T).apply(null,arguments)},n._wrenGetUserData=function(){return(n._wrenGetUserData=n.asm.U).apply(null,arguments)},n._wrenSetUserData=function(){return(n._wrenSetUserData=n.asm.V).apply(null,arguments)},n._shimNewVM=function(){return(n._shimNewVM=n.asm.X).apply(null,arguments)};var k,O=n._malloc=function(){return(O=n._malloc=n.asm.Y).apply(null,arguments)},D=n.stackSave=function(){return(D=n.stackSave=n.asm.Z).apply(null,arguments)},P=n.stackRestore=function(){return(P=n.stackRestore=n.asm._).apply(null,arguments)},$=n.stackAlloc=function(){return($=n.stackAlloc=n.asm.$).apply(null,arguments)};function x(e){C>0||(R(y),C>0||k||(k=!0,n.calledRun=!0,f||(R(v),r(n),R(F))))}return n.ccall=function(e,r,t,l,u){var o={string:function(e){var n=0;if(null!=e&&0!==e){var r=1+(e.length<<2);M(e,n=$(r),r)}return n},array:function(e){var n=$(e.length);return function(e,n){p.set(e,n)}(e,n),n}},a=function(e){return n["_"+e]}(e),i=[],s=0;if(l)for(var c=0;c<l.length;c++){var f=o[t[c]];f?(0===s&&(s=D()),i[c]=f(l[c])):i[c]=l[c]}var m=a.apply(null,i);return m=function(e){return 0!==s&&P(s),function(e){return"string"===r?S(e):"boolean"===r?Boolean(e):e}(e)}(m)},n.addFunction=function(e,n){if(i||(i=new WeakMap,function(e,n){for(var r=e;r<e+n;r++){var t=I(r);t&&i.set(t,r)}}(0,_.length)),i.has(e))return i.get(e);var r=function(){if(c.length)return c.pop();try{_.grow(1)}catch(e){if(!(e instanceof RangeError))throw e;throw"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH."}return _.length-1}();try{T(r,e)}catch(l){if(!(l instanceof TypeError))throw l;var t=function(e,n){if("function"==typeof WebAssembly.Function){for(var r={i:"i32",j:"i64",f:"f32",d:"f64"},t={parameters:[],results:"v"==n[0]?[]:[r[n[0]]]},l=1;l<n.length;++l)t.parameters.push(r[n[l]]);return new WebAssembly.Function(t,e)}var u=[1,0,1,96],o=n.slice(0,1),a=n.slice(1),i={i:127,j:126,f:125,d:124};for(u.push(a.length),l=0;l<a.length;++l)u.push(i[a[l]]);"v"==o?u.push(0):u=u.concat([1,i[o]]),u[1]=u.length-2;var s=new Uint8Array([0,97,115,109,1,0,0,0].concat(u,[2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0])),c=new WebAssembly.Module(s);return new WebAssembly.Instance(c,{e:{f:e}}).exports.f}(e,n);T(r,t)}return i.set(e,r),r},G=function e(){k||x(),k||(G=e)},n.run=x,x(),n.ready}})();let Module;async function load(){Module||(Module={},Module=await Module$1(),Module._VMs={})}function getVersionNumber(){return Module.ccall("wrenGetVersionNumber","number",[],[])}let ErrorType={COMPILE:0,RUNTIME:1,STACK_TRACE:2},InterpretResult={SUCCESS:0,COMPILE_ERROR:1,RUNTIME_ERROR:2},Type={BOOL:0,NUM:1,FOREIGN:2,LIST:3,MAP:4,NULL:5,STRING:6,UNKNOWN:7};class VM{constructor(e){this.config=Object.assign({},defaultConfig,e),this._ptr=Module.ccall("shimNewVM","number",[],[]),Module._VMs[this._ptr]=this,this._wb=""}get Module(){return Module}get heap(){return Module.HEAP8.buffer}_resolveModule(e,n){return this.config.resolveModuleFn(e,n)}_loadModule(e){let n=this.config.loadModuleFn(e);return n&&n.then?(n.then((n=>{null==n?n=`self__.transferError(${stringToWrenString(`Could not load module '${e}'`)})`:n+="\nself__.transfer()",this.interpret(e,n)}),(n=>{console.warn(`Error loading module source for "${e}"`,n),this.interpret(e,`self__.transferError(${stringToWrenString(String(n))})`)})),"var self__=Fiber.current\nFiber.suspend()\nself__=null"):n}_bindForeignMethod(e,n,r,t){let l=this.config.bindForeignMethodFn(e,n,r,t);return l?Module.addFunction(l.bind(null,this),"vi"):0}_bindForeignClass(e,n,r){let t=this.config.bindForeignClassFn(e,n);if(t){let e=t.allocate,n=t.finalize,l=new Uint32Array(this.heap,r);e&&(l[0]=Module.addFunction(e.bind(null,this),"vi")),n&&(l[1]=Module.addFunction(n,"vi"))}}_write(e){let n,r=0;for(;(n=e.indexOf("\n",r))>=0;){let t=this._wb+e.slice(r,n);this._wb="",r=n+1,this.config.writeFn(t)}this._wb+=e.slice(r)}_error(e,n,r,t){this.config.errorFn(e,n,r,t)}free(){Module.ccall("wrenFreeVM",null,["number"],[this._ptr]),delete Module._VMs[this._ptr],this._ptr=void 0}collectGarbage(){Module.ccall("wrenCollectGarbage",null,["number"],[this._ptr])}interpret(e,n){return Module.ccall("wrenInterpret","number",["number","string","string"],[this._ptr,e,n])}makeCallHandle(e){return Module.ccall("wrenMakeCallHandle","number",["number","string"],[this._ptr,e])}call(e){return Module.ccall("wrenCall","number",["number","number"],[this._ptr,e])}releaseHandle(e){Module.ccall("wrenReleaseHandle",null,["number","number"],[this._ptr,e])}getSlotCount(){return Module.ccall("wrenGetSlotCount","number",["number"],[this._ptr])}ensureSlots(e){Module.ccall("wrenEnsureSlots",null,["number","number"],[this._ptr,e])}getSlotType(e){return Module.ccall("wrenGetSlotType","number",["number","number"],[this._ptr,e])}getSlotBool(e){return Module.ccall("wrenGetSlotBool","boolean",["number","number"],[this._ptr,e])}getSlotBytes(e,n){let r=Module.ccall("wrenGetSlotBytes","number",["number","number","number"],[this._ptr,e,n]);return new Uint8Array(this.heap,r,n)}getSlotDouble(e){return Module.ccall("wrenGetSlotDouble","number",["number","number"],[this._ptr,e])}getSlotForeign(e){return Module.ccall("wrenGetSlotForeign","number",["number","number"],[this._ptr,e])}getSlotString(e){return Module.ccall("wrenGetSlotString","string",["number","number"],[this._ptr,e])}getSlotHandle(e){return Module.ccall("wrenGetSlotHandle","number",["number","number"],[this._ptr,e])}setSlotBool(e,n){Module.ccall("wrenSetSlotBool",null,["number","number","boolean"],[this._ptr,e,n])}setSlotBytes(e,n,r){Module.ccall("wrenSetSlotBytes",null,["number","number","array","number"],[this._ptr,e,n,r])}setSlotDouble(e,n){Module.ccall("wrenSetSlotDouble",null,["number","number","number"],[this._ptr,e,n])}setSlotNewForeign(e,n,r){return Module.ccall("wrenSetSlotNewForeign","number",["number","number","number","number"],[this._ptr,e,n,r])}setSlotNewList(e){Module.ccall("wrenSetSlotNewList",null,["number","number"],[this._ptr,e])}setSlotNewMap(e){Module.ccall("wrenSetSlotNewMap",null,["number","number"],[this._ptr,e])}setSlotNull(e){Module.ccall("wrenSetSlotNull",null,["number","number"],[this._ptr,e])}setSlotString(e,n){Module.ccall("wrenSetSlotString",null,["number","number","string"],[this._ptr,e,n])}setSlotHandle(e,n){Module.ccall("wrenSetSlotHandle",null,["number","number","number"],[this._ptr,e,n])}getListCount(e){return Module.ccall("wrenGetListCount","number",["number","number"],[this._ptr,e])}getListElement(e,n,r){Module.ccall("wrenGetListElement",null,["number","number","number","number"],[this._ptr,e,n,r])}setListElement(e,n,r){Module.ccall("wrenSetListElement",null,["number","number","number","number"],[this._ptr,e,n,r])}insertInList(e,n,r){Module.ccall("wrenInsertInList",null,["number","number","number","number"],[this._ptr,e,n,r])}getMapCount(e){return Module.ccall("wrenGetMapCount","number",["number","number"],[this._ptr,e])}getMapContainsKey(e,n){return Module.ccall("wrenGetMapContainsKey","boolean",["number","number","number"],[this._ptr,e,n])}getMapValue(e,n,r){Module.ccall("wrenGetMapValue",null,["number","number","number","number"],[this._ptr,e,n,r])}setMapValue(e,n,r){Module.ccall("wrenSetMapValue",null,["number","number","number","number"],[this._ptr,e,n,r])}removeMapValue(e,n,r){Module.ccall("wrenRemoveMapValue",null,["number","number","number","number"],[this._ptr,e,n,r])}getVariable(e,n,r){Module.ccall("wrenGetVariable",null,["number","string","string","number"],[this._ptr,e,n,r])}hasVariable(e,n){return Module.ccall("wrenHasVariable","boolean",["number","string","string"],[this._ptr,e,n])}hasModule(e){return Module.ccall("wrenHasModule","boolean",["number","string"],[this._ptr,e])}abortFiber(e){Module.ccall("wrenAbortFiber",null,["number","number"],[this._ptr,e])}}function stringToWrenString(e){let n='"';for(let r=0;r<e.length;r++){let t=e[r];n+="\\"===t?"\\\\":"%"===t||'"'===t?"\\"+t:t}return n+'"'}let defaultConfig={resolveModuleFn:defaultResolveModuleFn,loadModuleFn:defaultLoadModuleFn,bindForeignMethodFn:defaultBindForeignMethodFn,bindForeignClassFn:defaultBindForeignClassFn,writeFn:defaultWriteFn,errorFn:defaultErrorFn};function defaultResolveModuleFn(e,n){return n}async function defaultLoadModuleFn(e){return null}function defaultBindForeignMethodFn(e,n,r,t){return function(e){}}function defaultBindForeignClassFn(e,n){return null}function defaultWriteFn(e){console.log("WREN: "+e)}function defaultErrorFn(e,n,r,t){let l;return 0===e?l=`Compile Error [${n}:${r}]: ${t}`:1===e?l=`Error: ${t}`:2===e&&(l=`at ${t} ${n}:${r}`),console.error("WREN: "+l),l}var wren={load:load,getVersionNumber:getVersionNumber,ErrorType:ErrorType,InterpretResult:InterpretResult,Type:Type,VM:VM,defaultConfig:defaultConfig};export default wren;export{ErrorType,InterpretResult,Type,VM,defaultConfig,getVersionNumber,load};