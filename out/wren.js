var n,e=(n=import.meta.url,function(e){var r,t;function l(n){if(!n)return 0;if("string"==typeof n){var e=function(n){for(var e=0,r=0;r<n.length;++r){var t=n.charCodeAt(r);t>=55296&&t<=57343&&(t=65536+((1023&t)<<10)|1023&n.charCodeAt(++r)),t<=127?++e:e+=t<=2047?2:t<=65535?3:4}return e}(n)+1;return g(n,t=O(e),e),t}n instanceof ArrayBuffer&&(n=new Uint8Array(n));var r=0===n[n.length-1],t=(e=r?n.length:n.length+1,O(e));return p.set(n,t),r||(p[ptr+e-1]=0),t}(e=void 0!==(e=e||{})?e:{}).ready=new Promise((function(n,e){r=n,t=e}));var u=Object.assign({},e),a="";"undefined"!=typeof document&&document.currentScript&&(a=document.currentScript.src),n&&(a=n),a=0!==a.indexOf("blob:")?a.substr(0,a.replace(/[?#].*/,"").lastIndexOf("/")+1):"",console.log.bind(console);var o=console.warn.bind(console);Object.assign(e,u),u=null;var i,s,c=[];"object"!=typeof WebAssembly&&E("no native wasm support detected");var f,m,p,b,w,_,h=!1,S="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function y(n,e){return n?function(n,e,r){for(var t=e+r,l=e;n[l]&&!(l>=t);)++l;if(l-e>16&&n.buffer&&S)return S.decode(n.subarray(e,l));for(var u="";e<l;){var a=n[e++];if(128&a){var o=63&n[e++];if(192!=(224&a)){var i=63&n[e++];if((a=224==(240&a)?(15&a)<<12|o<<6|i:(7&a)<<18|o<<12|i<<6|63&n[e++])<65536)u+=String.fromCharCode(a);else{var s=a-65536;u+=String.fromCharCode(55296|s>>10,56320|1023&s)}}else u+=String.fromCharCode((31&a)<<6|o)}else u+=String.fromCharCode(a)}return u}(p,n,e):""}function g(n,e,r){return function(n,e,r,t){if(!(t>0))return 0;for(var l=r,u=r+t-1,a=0;a<n.length;++a){var o=n.charCodeAt(a);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&n.charCodeAt(++a)),o<=127){if(r>=u)break;e[r++]=o}else if(o<=2047){if(r+1>=u)break;e[r++]=192|o>>6,e[r++]=128|63&o}else if(o<=65535){if(r+2>=u)break;e[r++]=224|o>>12,e[r++]=128|o>>6&63,e[r++]=128|63&o}else{if(r+3>=u)break;e[r++]=240|o>>18,e[r++]=128|o>>12&63,e[r++]=128|o>>6&63,e[r++]=128|63&o}}return e[r]=0,r-l}(n,p,e,r)}function d(n){f=n,e.HEAP8=m=new Int8Array(n),e.HEAP16=new Int16Array(n),e.HEAP32=b=new Int32Array(n),e.HEAPU8=p=new Uint8Array(n),e.HEAPU16=new Uint16Array(n),e.HEAPU32=new Uint32Array(n),e.HEAPF32=new Float32Array(n),e.HEAPF64=w=new Float64Array(n)}var v,M=[],G=[],C=[],A=0,F=null;function E(n){o(n="Aborted("+n+")"),h=!0,n+=". Build with -s ASSERTIONS=1 for more info.";var e=new WebAssembly.RuntimeError(n);throw t(e),e}function V(n){return n.startsWith("data:application/octet-stream;base64,")}function N(n){try{throw"both async and sync fetching of the wasm failed"}catch(n){E(n)}}e.preloadedImages={},e.preloadedAudios={},e.locateFile?V(v="wren.wasm")||(v=a+v):v=new URL("wren.wasm",import.meta.url).toString();var H={39316:function(n,r,t){return l(e._VMs[n]._resolveModule(y(r),y(t)))},39411:function(n,r){return l(e._VMs[n]._loadModule(y(r)))},39485:function(n,r,t,l,u){return e._VMs[n]._bindForeignMethod(y(r),y(t),1===l,y(u))},39599:function(n,r,t,l){return e._VMs[n]._bindForeignClass(y(r),y(t),l)},39688:function(n,r){e._VMs[n]._write(y(r))},39734:function(n,r,t,l,u){e._VMs[n]._error(r,y(t),l,y(u))}};function L(n){for(;n.length>0;){var r=n.shift();if("function"!=typeof r){var t=r.func;"number"==typeof t?void 0===r.arg?I(t)():I(t)(r.arg):t(void 0===r.arg?null:r.arg)}else r(e)}}var R=[];function I(n){var e=R[n];return e||(n>=R.length&&(R.length=n+1),R[n]=e=_.get(n)),e}function B(n,e){_.set(n,e),R[n]=e}var U=[];function k(n){try{return s.grow(n-f.byteLength+65535>>>16),d(s.buffer),1}catch(n){}}var W={b:function(){return Date.now()},a:function(n,e,r){var t=function(n,e){var r;for(U.length=0,e>>=2;r=p[n++];){var t=r<105;t&&1&e&&e++,U.push(t?w[e++>>1]:b[e]),++e}return U}(e,r);return H[n].apply(null,t)},d:function(n,e,r){p.copyWithin(n,e,e+r)},c:function(n){var e,r,t=p.length,l=2147483648;if((n>>>=0)>l)return!1;for(var u=1;u<=4;u*=2){var a=t*(1+.2/u);if(a=Math.min(a,n+100663296),k(Math.min(l,(e=Math.max(n,a))+((r=65536)-e%r)%r)))return!0}return!1}};!function(){var n={a:W};function r(n,r){var t,l=n.exports;e.asm=l,d((s=e.asm.e).buffer),_=e.asm.W,t=e.asm.f,G.unshift(t),function(n){if(0==--A&&F){var e=F;F=null,e()}}()}function l(n){r(n.instance)}function u(e){return("function"==typeof fetch?fetch(v,{credentials:"same-origin"}).then((function(n){if(!n.ok)throw"failed to load wasm binary file at '"+v+"'";return n.arrayBuffer()})).catch((function(){return N()})):Promise.resolve().then((function(){return N()}))).then((function(e){return WebAssembly.instantiate(e,n)})).then((function(n){return n})).then(e,(function(n){o("failed to asynchronously prepare wasm: "+n),E(n)}))}if(A++,e.instantiateWasm)try{return e.instantiateWasm(n,r)}catch(n){return o("Module.instantiateWasm callback failed with error: "+n),!1}("function"!=typeof WebAssembly.instantiateStreaming||V(v)||"function"!=typeof fetch?u(l):fetch(v,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,n).then(l,(function(n){return o("wasm streaming compile failed: "+n),o("falling back to ArrayBuffer instantiation"),u(l)}))}))).catch(t)}(),e.___wasm_call_ctors=function(){return(e.___wasm_call_ctors=e.asm.f).apply(null,arguments)},e._wrenCollectGarbage=function(){return(e._wrenCollectGarbage=e.asm.g).apply(null,arguments)},e._wrenInterpret=function(){return(e._wrenInterpret=e.asm.h).apply(null,arguments)},e._wrenGetVersionNumber=function(){return(e._wrenGetVersionNumber=e.asm.i).apply(null,arguments)},e._wrenInitConfiguration=function(){return(e._wrenInitConfiguration=e.asm.j).apply(null,arguments)},e._wrenNewVM=function(){return(e._wrenNewVM=e.asm.k).apply(null,arguments)},e._wrenFreeVM=function(){return(e._wrenFreeVM=e.asm.l).apply(null,arguments)},e._wrenMakeCallHandle=function(){return(e._wrenMakeCallHandle=e.asm.m).apply(null,arguments)},e._wrenCall=function(){return(e._wrenCall=e.asm.n).apply(null,arguments)},e._wrenReleaseHandle=function(){return(e._wrenReleaseHandle=e.asm.o).apply(null,arguments)},e._wrenGetSlotCount=function(){return(e._wrenGetSlotCount=e.asm.p).apply(null,arguments)},e._wrenEnsureSlots=function(){return(e._wrenEnsureSlots=e.asm.q).apply(null,arguments)},e._wrenGetSlotType=function(){return(e._wrenGetSlotType=e.asm.r).apply(null,arguments)},e._wrenGetSlotBool=function(){return(e._wrenGetSlotBool=e.asm.s).apply(null,arguments)},e._wrenGetSlotBytes=function(){return(e._wrenGetSlotBytes=e.asm.t).apply(null,arguments)},e._wrenGetSlotDouble=function(){return(e._wrenGetSlotDouble=e.asm.u).apply(null,arguments)},e._wrenGetSlotForeign=function(){return(e._wrenGetSlotForeign=e.asm.v).apply(null,arguments)},e._wrenGetSlotString=function(){return(e._wrenGetSlotString=e.asm.w).apply(null,arguments)},e._wrenGetSlotHandle=function(){return(e._wrenGetSlotHandle=e.asm.x).apply(null,arguments)},e._wrenSetSlotBool=function(){return(e._wrenSetSlotBool=e.asm.y).apply(null,arguments)},e._wrenSetSlotBytes=function(){return(e._wrenSetSlotBytes=e.asm.z).apply(null,arguments)},e._wrenSetSlotDouble=function(){return(e._wrenSetSlotDouble=e.asm.A).apply(null,arguments)},e._wrenSetSlotNewForeign=function(){return(e._wrenSetSlotNewForeign=e.asm.B).apply(null,arguments)},e._wrenSetSlotNewList=function(){return(e._wrenSetSlotNewList=e.asm.C).apply(null,arguments)},e._wrenSetSlotNewMap=function(){return(e._wrenSetSlotNewMap=e.asm.D).apply(null,arguments)},e._wrenSetSlotNull=function(){return(e._wrenSetSlotNull=e.asm.E).apply(null,arguments)},e._wrenSetSlotString=function(){return(e._wrenSetSlotString=e.asm.F).apply(null,arguments)},e._wrenSetSlotHandle=function(){return(e._wrenSetSlotHandle=e.asm.G).apply(null,arguments)},e._wrenGetListCount=function(){return(e._wrenGetListCount=e.asm.H).apply(null,arguments)},e._wrenGetListElement=function(){return(e._wrenGetListElement=e.asm.I).apply(null,arguments)},e._wrenSetListElement=function(){return(e._wrenSetListElement=e.asm.J).apply(null,arguments)},e._wrenInsertInList=function(){return(e._wrenInsertInList=e.asm.K).apply(null,arguments)},e._wrenGetMapCount=function(){return(e._wrenGetMapCount=e.asm.L).apply(null,arguments)},e._wrenGetMapContainsKey=function(){return(e._wrenGetMapContainsKey=e.asm.M).apply(null,arguments)},e._wrenGetMapValue=function(){return(e._wrenGetMapValue=e.asm.N).apply(null,arguments)},e._wrenSetMapValue=function(){return(e._wrenSetMapValue=e.asm.O).apply(null,arguments)},e._wrenRemoveMapValue=function(){return(e._wrenRemoveMapValue=e.asm.P).apply(null,arguments)},e._wrenGetVariable=function(){return(e._wrenGetVariable=e.asm.Q).apply(null,arguments)},e._wrenHasVariable=function(){return(e._wrenHasVariable=e.asm.R).apply(null,arguments)},e._wrenHasModule=function(){return(e._wrenHasModule=e.asm.S).apply(null,arguments)},e._wrenAbortFiber=function(){return(e._wrenAbortFiber=e.asm.T).apply(null,arguments)},e._wrenGetUserData=function(){return(e._wrenGetUserData=e.asm.U).apply(null,arguments)},e._wrenSetUserData=function(){return(e._wrenSetUserData=e.asm.V).apply(null,arguments)},e._shimNewVM=function(){return(e._shimNewVM=e.asm.X).apply(null,arguments)};var T,O=e._malloc=function(){return(O=e._malloc=e.asm.Y).apply(null,arguments)},D=e.stackSave=function(){return(D=e.stackSave=e.asm.Z).apply(null,arguments)},P=e.stackRestore=function(){return(P=e.stackRestore=e.asm._).apply(null,arguments)},$=e.stackAlloc=function(){return($=e.stackAlloc=e.asm.$).apply(null,arguments)};function x(n){A>0||(L(M),A>0||T||(T=!0,e.calledRun=!0,h||(L(G),r(e),L(C))))}return e.ccall=function(n,r,t,l,u){var a={string:function(n){var e=0;if(null!=n&&0!==n){var r=1+(n.length<<2);g(n,e=$(r),r)}return e},array:function(n){var e=$(n.length);return function(n,e){m.set(n,e)}(n,e),e}},o=function(n){return e["_"+n]}(n),i=[],s=0;if(l)for(var c=0;c<l.length;c++){var f=a[t[c]];f?(0===s&&(s=D()),i[c]=f(l[c])):i[c]=l[c]}var p=o.apply(null,i);return p=function(n){return 0!==s&&P(s),function(n){return"string"===r?y(n):"boolean"===r?Boolean(n):n}(n)}(p)},e.addFunction=function(n,e){if(i||(i=new WeakMap,function(n,e){for(var r=n;r<n+e;r++){var t=I(r);t&&i.set(t,r)}}(0,_.length)),i.has(n))return i.get(n);var r=function(){if(c.length)return c.pop();try{_.grow(1)}catch(n){if(!(n instanceof RangeError))throw n;throw"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH."}return _.length-1}();try{B(r,n)}catch(l){if(!(l instanceof TypeError))throw l;var t=function(n,e){if("function"==typeof WebAssembly.Function){for(var r={i:"i32",j:"i64",f:"f32",d:"f64"},t={parameters:[],results:"v"==e[0]?[]:[r[e[0]]]},l=1;l<e.length;++l)t.parameters.push(r[e[l]]);return new WebAssembly.Function(t,n)}var u=[1,0,1,96],a=e.slice(0,1),o=e.slice(1),i={i:127,j:126,f:125,d:124};for(u.push(o.length),l=0;l<o.length;++l)u.push(i[o[l]]);"v"==a?u.push(0):u=u.concat([1,i[a]]),u[1]=u.length-2;var s=new Uint8Array([0,97,115,109,1,0,0,0].concat(u,[2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0])),c=new WebAssembly.Module(s);return new WebAssembly.Instance(c,{e:{f:n}}).exports.f}(n,e);B(r,t)}return i.set(n,r),r},F=function n(){T||x(),T||(F=n)},e.run=x,x(),e.ready});let r,t;async function l(){r||(r={},r=await e(),t=r.HEAPU8,r._VMs={})}function u(){return r.ccall("wrenGetVersionNumber","number",[],[])}let a={COMPILE:0,RUNTIME:1,STACK_TRACE:2},o={SUCCESS:0,COMPILE_ERROR:1,RUNTIME_ERROR:2},i={BOOL:0,NUM:1,FOREIGN:2,LIST:3,MAP:4,NULL:5,STRING:6,UNKNOWN:7};class s{constructor(n){this.config=Object.assign({},m,n),this._ptr=r.ccall("shimNewVM","number",[],[]),r._VMs[this._ptr]=this,this._wb=""}get Module(){return r}get heap(){return t.buffer}_resolveModule(n,e){return this.config.resolveModuleFn(n,e)}_loadModule(n){let e=this.config.loadModuleFn(n);return e&&e.then?(e.then((e=>{null==e?this.interpret(n,`self__.transferError(${f(`Could not load module '${n}'`)})`):(this.interpret(n,e),this.interpret(n,"self__.transfer()"))}),(e=>{console.warn(`Error loading module source for "${n}"`,e),this.interpret(n,`self__.transferError(${f(String(e))})`)})),"var self__=Fiber.current\nFiber.suspend()\nself__=null"):e}_bindForeignMethod(n,e,t,l){let u=this.config.bindForeignMethodFn(n,e,t,l);return u?r.addFunction(u.bind(null,this),"vi"):0}_bindForeignClass(n,e,t){let l=this.config.bindForeignClassFn(n,e);if(l){let n=l.allocate,e=l.finalize,u=new Uint32Array(this.heap,t);n&&(u[0]=r.addFunction(n.bind(null,this),"vi")),e&&(u[1]=r.addFunction(e,"vi"))}}_write(n){let e,r=0;for(;(e=n.indexOf("\n",r))>=0;){let t=this._wb+n.slice(r,e);this._wb="",r=e+1,this.config.writeFn(t)}this._wb+=n.slice(r)}_error(n,e,r,t){this.config.errorFn(n,e,r,t)}free(){r.ccall("wrenFreeVM",null,["number"],[this._ptr]),delete r._VMs[this._ptr],this._ptr=void 0}collectGarbage(){r.ccall("wrenCollectGarbage",null,["number"],[this._ptr])}interpret(n,e){let t,l=0;"string"==typeof e?t="string":(l=r.stackSave(),e=c(e),t="number");let u=r.ccall("wrenInterpret","number",["number","string",t],[this._ptr,n,e]);return l&&r.stackRestore(l),u}makeCallHandle(n){return r.ccall("wrenMakeCallHandle","number",["number","string"],[this._ptr,n])}call(n){return r.ccall("wrenCall","number",["number","number"],[this._ptr,n])}releaseHandle(n){r.ccall("wrenReleaseHandle",null,["number","number"],[this._ptr,n])}getSlotCount(){return r.ccall("wrenGetSlotCount","number",["number"],[this._ptr])}ensureSlots(n){r.ccall("wrenEnsureSlots",null,["number","number"],[this._ptr,n])}getSlotType(n){return r.ccall("wrenGetSlotType","number",["number","number"],[this._ptr,n])}getSlotBool(n){return r.ccall("wrenGetSlotBool","boolean",["number","number"],[this._ptr,n])}getSlotBytes(n,e){let t=r.ccall("wrenGetSlotBytes","number",["number","number","number"],[this._ptr,n,e]);return new Uint8Array(this.heap,t,e)}getSlotDouble(n){return r.ccall("wrenGetSlotDouble","number",["number","number"],[this._ptr,n])}getSlotForeign(n){return r.ccall("wrenGetSlotForeign","number",["number","number"],[this._ptr,n])}getSlotString(n){return r.ccall("wrenGetSlotString","string",["number","number"],[this._ptr,n])}getSlotHandle(n){return r.ccall("wrenGetSlotHandle","number",["number","number"],[this._ptr,n])}setSlotBool(n,e){r.ccall("wrenSetSlotBool",null,["number","number","boolean"],[this._ptr,n,e])}setSlotBytes(n,e,t){null==t&&(t=e.byteLength),r.ccall("wrenSetSlotBytes",null,["number","number","array","number"],[this._ptr,n,e,t])}setSlotDouble(n,e){r.ccall("wrenSetSlotDouble",null,["number","number","number"],[this._ptr,n,e])}setSlotNewForeign(n,e,t){return r.ccall("wrenSetSlotNewForeign","number",["number","number","number","number"],[this._ptr,n,e,t])}setSlotNewList(n){r.ccall("wrenSetSlotNewList",null,["number","number"],[this._ptr,n])}setSlotNewMap(n){r.ccall("wrenSetSlotNewMap",null,["number","number"],[this._ptr,n])}setSlotNull(n){r.ccall("wrenSetSlotNull",null,["number","number"],[this._ptr,n])}setSlotString(n,e){let t,l=0;"string"==typeof e?t="string":(l=r.stackSave(),e=c(e),t="number"),r.ccall("wrenSetSlotString",null,["number","number",t],[this._ptr,n,e]),l&&r.stackRestore(l)}setSlotHandle(n,e){r.ccall("wrenSetSlotHandle",null,["number","number","number"],[this._ptr,n,e])}getListCount(n){return r.ccall("wrenGetListCount","number",["number","number"],[this._ptr,n])}getListElement(n,e,t){r.ccall("wrenGetListElement",null,["number","number","number","number"],[this._ptr,n,e,t])}setListElement(n,e,t){r.ccall("wrenSetListElement",null,["number","number","number","number"],[this._ptr,n,e,t])}insertInList(n,e,t){r.ccall("wrenInsertInList",null,["number","number","number","number"],[this._ptr,n,e,t])}getMapCount(n){return r.ccall("wrenGetMapCount","number",["number","number"],[this._ptr,n])}getMapContainsKey(n,e){return r.ccall("wrenGetMapContainsKey","boolean",["number","number","number"],[this._ptr,n,e])}getMapValue(n,e,t){r.ccall("wrenGetMapValue",null,["number","number","number","number"],[this._ptr,n,e,t])}setMapValue(n,e,t){r.ccall("wrenSetMapValue",null,["number","number","number","number"],[this._ptr,n,e,t])}removeMapValue(n,e,t){r.ccall("wrenRemoveMapValue",null,["number","number","number","number"],[this._ptr,n,e,t])}getVariable(n,e,t){r.ccall("wrenGetVariable",null,["number","string","string","number"],[this._ptr,n,e,t])}hasVariable(n,e){return r.ccall("wrenHasVariable","boolean",["number","string","string"],[this._ptr,n,e])}hasModule(n){return r.ccall("wrenHasModule","boolean",["number","string"],[this._ptr,n])}abortFiber(n){r.ccall("wrenAbortFiber",null,["number","number"],[this._ptr,n])}}function c(n){n instanceof ArrayBuffer&&(n=new Uint8Array(n));let e=0===n[n.length-1],l=e?n.length:n.length+1,u=r.stackAlloc(l);return t.set(n,u),e||(t[u+l-1]=0),u}function f(n){let e='"';for(let r=0;r<n.length;r++){let t=n[r];e+="\\"===t?"\\\\":"%"===t||'"'===t?"\\"+t:t}return e+'"'}let m={resolveModuleFn:function(n,e){return e},loadModuleFn:async function(n){return null},bindForeignMethodFn:function(n,e,r,t){return function(n){}},bindForeignClassFn:function(n,e){return null},writeFn:function(n){console.log("WREN: "+n)},errorFn:function(n,e,r,t){let l;0===n?l=`Compile Error [${e}:${r}]: ${t}`:1===n?l=`Error: ${t}`:2===n&&(l=`at ${t} ${e}:${r}`);return console.error("WREN: "+l),l}};var p={load:l,getVersionNumber:u,ErrorType:a,InterpretResult:o,Type:i,VM:s,defaultConfig:m};export{a as ErrorType,o as InterpretResult,i as Type,s as VM,p as default,m as defaultConfig,u as getVersionNumber,l as load};