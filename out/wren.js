var e,n=(e=import.meta.url,function(n){var r,t;function l(e){if(!e)return 0;if("string"==typeof e){var n=function(e){for(var n=0,r=0;r<e.length;++r){var t=e.charCodeAt(r);t>=55296&&t<=57343&&(t=65536+((1023&t)<<10)|1023&e.charCodeAt(++r)),t<=127?++n:n+=t<=2047?2:t<=65535?3:4}return n}(e)+1;return g(e,t=O(n),n),t}e instanceof ArrayBuffer&&(e=new Uint8Array(e));var r=0===e[e.length-1],t=(n=r?e.length:e.length+1,O(n));return p.set(e,t),r||(p[ptr+n-1]=0),t}(n=void 0!==(n=n||{})?n:{}).ready=new Promise((function(e,n){r=e,t=n}));var u=Object.assign({},n),a="";"undefined"!=typeof document&&document.currentScript&&(a=document.currentScript.src),e&&(a=e),a=0!==a.indexOf("blob:")?a.substr(0,a.replace(/[?#].*/,"").lastIndexOf("/")+1):"",console.log.bind(console);var o=console.warn.bind(console);Object.assign(n,u),u=null;var i,s,c=[];"object"!=typeof WebAssembly&&E("no native wasm support detected");var f,m,p,b,w,_,h=!1,S="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function y(e,n){return e?function(e,n,r){for(var t=n+r,l=n;e[l]&&!(l>=t);)++l;if(l-n>16&&e.buffer&&S)return S.decode(e.subarray(n,l));for(var u="";n<l;){var a=e[n++];if(128&a){var o=63&e[n++];if(192!=(224&a)){var i=63&e[n++];if((a=224==(240&a)?(15&a)<<12|o<<6|i:(7&a)<<18|o<<12|i<<6|63&e[n++])<65536)u+=String.fromCharCode(a);else{var s=a-65536;u+=String.fromCharCode(55296|s>>10,56320|1023&s)}}else u+=String.fromCharCode((31&a)<<6|o)}else u+=String.fromCharCode(a)}return u}(p,e,n):""}function g(e,n,r){return function(e,n,r,t){if(!(t>0))return 0;for(var l=r,u=r+t-1,a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&e.charCodeAt(++a)),o<=127){if(r>=u)break;n[r++]=o}else if(o<=2047){if(r+1>=u)break;n[r++]=192|o>>6,n[r++]=128|63&o}else if(o<=65535){if(r+2>=u)break;n[r++]=224|o>>12,n[r++]=128|o>>6&63,n[r++]=128|63&o}else{if(r+3>=u)break;n[r++]=240|o>>18,n[r++]=128|o>>12&63,n[r++]=128|o>>6&63,n[r++]=128|63&o}}return n[r]=0,r-l}(e,p,n,r)}function d(e){f=e,n.HEAP8=m=new Int8Array(e),n.HEAP16=new Int16Array(e),n.HEAP32=b=new Int32Array(e),n.HEAPU8=p=new Uint8Array(e),n.HEAPU16=new Uint16Array(e),n.HEAPU32=new Uint32Array(e),n.HEAPF32=new Float32Array(e),n.HEAPF64=w=new Float64Array(e)}var v,M=[],A=[],G=[],C=0,F=null;function E(e){o(e="Aborted("+e+")"),h=!0,e+=". Build with -s ASSERTIONS=1 for more info.";var n=new WebAssembly.RuntimeError(e);throw t(n),n}function V(e){return e.startsWith("data:application/octet-stream;base64,")}function N(e){try{throw"both async and sync fetching of the wasm failed"}catch(e){E(e)}}n.preloadedImages={},n.preloadedAudios={},n.locateFile?V(v="wren.wasm")||(v=a+v):v=new URL("wren.wasm",import.meta.url).toString();var H={39316:function(e,r,t){return l(n._VMs[e]._resolveModule(y(r),y(t)))},39411:function(e,r){return l(n._VMs[e]._loadModule(y(r)))},39485:function(e,r,t,l,u){return n._VMs[e]._bindForeignMethod(y(r),y(t),1===l,y(u))},39599:function(e,r,t,l){return n._VMs[e]._bindForeignClass(y(r),y(t),l)},39688:function(e,r){n._VMs[e]._write(y(r))},39734:function(e,r,t,l,u){n._VMs[e]._error(r,y(t),l,y(u))}};function L(e){for(;e.length>0;){var r=e.shift();if("function"!=typeof r){var t=r.func;"number"==typeof t?void 0===r.arg?I(t)():I(t)(r.arg):t(void 0===r.arg?null:r.arg)}else r(n)}}var R=[];function I(e){var n=R[e];return n||(e>=R.length&&(R.length=e+1),R[e]=n=_.get(e)),n}function k(e,n){_.set(e,n),R[e]=n}var B=[];function U(e){try{return s.grow(e-f.byteLength+65535>>>16),d(s.buffer),1}catch(e){}}var W={b:function(){return Date.now()},a:function(e,n,r){var t=function(e,n){var r;for(B.length=0,n>>=2;r=p[e++];){var t=r<105;t&&1&n&&n++,B.push(t?w[n++>>1]:b[n]),++n}return B}(n,r);return H[e].apply(null,t)},d:function(e,n,r){p.copyWithin(e,n,n+r)},c:function(e){var n,r,t=p.length,l=2147483648;if((e>>>=0)>l)return!1;for(var u=1;u<=4;u*=2){var a=t*(1+.2/u);if(a=Math.min(a,e+100663296),U(Math.min(l,(n=Math.max(e,a))+((r=65536)-n%r)%r)))return!0}return!1}};!function(){var e={a:W};function r(e,r){var t,l=e.exports;n.asm=l,d((s=n.asm.e).buffer),_=n.asm.Y,t=n.asm.f,A.unshift(t),function(e){if(0==--C&&F){var n=F;F=null,n()}}()}function l(e){r(e.instance)}function u(n){return("function"==typeof fetch?fetch(v,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+v+"'";return e.arrayBuffer()})).catch((function(){return N()})):Promise.resolve().then((function(){return N()}))).then((function(n){return WebAssembly.instantiate(n,e)})).then((function(e){return e})).then(n,(function(e){o("failed to asynchronously prepare wasm: "+e),E(e)}))}if(C++,n.instantiateWasm)try{return n.instantiateWasm(e,r)}catch(e){return o("Module.instantiateWasm callback failed with error: "+e),!1}("function"!=typeof WebAssembly.instantiateStreaming||V(v)||"function"!=typeof fetch?u(l):fetch(v,{credentials:"same-origin"}).then((function(n){return WebAssembly.instantiateStreaming(n,e).then(l,(function(e){return o("wasm streaming compile failed: "+e),o("falling back to ArrayBuffer instantiation"),u(l)}))}))).catch(t)}(),n.___wasm_call_ctors=function(){return(n.___wasm_call_ctors=n.asm.f).apply(null,arguments)},n._wrenCollectGarbage=function(){return(n._wrenCollectGarbage=n.asm.g).apply(null,arguments)},n._wrenInterpret=function(){return(n._wrenInterpret=n.asm.h).apply(null,arguments)},n._wrenGetVersionNumber=function(){return(n._wrenGetVersionNumber=n.asm.i).apply(null,arguments)},n._wrenInitConfiguration=function(){return(n._wrenInitConfiguration=n.asm.j).apply(null,arguments)},n._free=function(){return(n._free=n.asm.k).apply(null,arguments)},n._realloc=function(){return(n._realloc=n.asm.l).apply(null,arguments)},n._wrenNewVM=function(){return(n._wrenNewVM=n.asm.m).apply(null,arguments)},n._wrenFreeVM=function(){return(n._wrenFreeVM=n.asm.n).apply(null,arguments)},n._wrenMakeCallHandle=function(){return(n._wrenMakeCallHandle=n.asm.o).apply(null,arguments)},n._wrenCall=function(){return(n._wrenCall=n.asm.p).apply(null,arguments)},n._wrenReleaseHandle=function(){return(n._wrenReleaseHandle=n.asm.q).apply(null,arguments)},n._wrenGetSlotCount=function(){return(n._wrenGetSlotCount=n.asm.r).apply(null,arguments)},n._wrenEnsureSlots=function(){return(n._wrenEnsureSlots=n.asm.s).apply(null,arguments)},n._wrenGetSlotType=function(){return(n._wrenGetSlotType=n.asm.t).apply(null,arguments)},n._wrenGetSlotBool=function(){return(n._wrenGetSlotBool=n.asm.u).apply(null,arguments)},n._wrenGetSlotBytes=function(){return(n._wrenGetSlotBytes=n.asm.v).apply(null,arguments)},n._wrenGetSlotDouble=function(){return(n._wrenGetSlotDouble=n.asm.w).apply(null,arguments)},n._wrenGetSlotForeign=function(){return(n._wrenGetSlotForeign=n.asm.x).apply(null,arguments)},n._wrenGetSlotString=function(){return(n._wrenGetSlotString=n.asm.y).apply(null,arguments)},n._wrenGetSlotHandle=function(){return(n._wrenGetSlotHandle=n.asm.z).apply(null,arguments)},n._wrenSetSlotBool=function(){return(n._wrenSetSlotBool=n.asm.A).apply(null,arguments)},n._wrenSetSlotBytes=function(){return(n._wrenSetSlotBytes=n.asm.B).apply(null,arguments)},n._wrenSetSlotDouble=function(){return(n._wrenSetSlotDouble=n.asm.C).apply(null,arguments)},n._wrenSetSlotNewForeign=function(){return(n._wrenSetSlotNewForeign=n.asm.D).apply(null,arguments)},n._wrenSetSlotNewList=function(){return(n._wrenSetSlotNewList=n.asm.E).apply(null,arguments)},n._wrenSetSlotNewMap=function(){return(n._wrenSetSlotNewMap=n.asm.F).apply(null,arguments)},n._wrenSetSlotNull=function(){return(n._wrenSetSlotNull=n.asm.G).apply(null,arguments)},n._wrenSetSlotString=function(){return(n._wrenSetSlotString=n.asm.H).apply(null,arguments)},n._wrenSetSlotHandle=function(){return(n._wrenSetSlotHandle=n.asm.I).apply(null,arguments)},n._wrenGetListCount=function(){return(n._wrenGetListCount=n.asm.J).apply(null,arguments)},n._wrenGetListElement=function(){return(n._wrenGetListElement=n.asm.K).apply(null,arguments)},n._wrenSetListElement=function(){return(n._wrenSetListElement=n.asm.L).apply(null,arguments)},n._wrenInsertInList=function(){return(n._wrenInsertInList=n.asm.M).apply(null,arguments)},n._wrenGetMapCount=function(){return(n._wrenGetMapCount=n.asm.N).apply(null,arguments)},n._wrenGetMapContainsKey=function(){return(n._wrenGetMapContainsKey=n.asm.O).apply(null,arguments)},n._wrenGetMapValue=function(){return(n._wrenGetMapValue=n.asm.P).apply(null,arguments)},n._wrenSetMapValue=function(){return(n._wrenSetMapValue=n.asm.Q).apply(null,arguments)},n._wrenRemoveMapValue=function(){return(n._wrenRemoveMapValue=n.asm.R).apply(null,arguments)},n._wrenGetVariable=function(){return(n._wrenGetVariable=n.asm.S).apply(null,arguments)},n._wrenHasVariable=function(){return(n._wrenHasVariable=n.asm.T).apply(null,arguments)},n._wrenHasModule=function(){return(n._wrenHasModule=n.asm.U).apply(null,arguments)},n._wrenAbortFiber=function(){return(n._wrenAbortFiber=n.asm.V).apply(null,arguments)},n._wrenGetUserData=function(){return(n._wrenGetUserData=n.asm.W).apply(null,arguments)},n._wrenSetUserData=function(){return(n._wrenSetUserData=n.asm.X).apply(null,arguments)},n._shimNewVM=function(){return(n._shimNewVM=n.asm.Z).apply(null,arguments)};var T,O=n._malloc=function(){return(O=n._malloc=n.asm._).apply(null,arguments)},D=n.stackSave=function(){return(D=n.stackSave=n.asm.$).apply(null,arguments)},P=n.stackRestore=function(){return(P=n.stackRestore=n.asm.aa).apply(null,arguments)},$=n.stackAlloc=function(){return($=n.stackAlloc=n.asm.ba).apply(null,arguments)};function x(e){C>0||(L(M),C>0||T||(T=!0,n.calledRun=!0,h||(L(A),r(n),L(G))))}return n.ccall=function(e,r,t,l,u){var a={string:function(e){var n=0;if(null!=e&&0!==e){var r=1+(e.length<<2);g(e,n=$(r),r)}return n},array:function(e){var n=$(e.length);return function(e,n){m.set(e,n)}(e,n),n}},o=function(e){return n["_"+e]}(e),i=[],s=0;if(l)for(var c=0;c<l.length;c++){var f=a[t[c]];f?(0===s&&(s=D()),i[c]=f(l[c])):i[c]=l[c]}var p=o.apply(null,i);return p=function(e){return 0!==s&&P(s),function(e){return"string"===r?y(e):"boolean"===r?Boolean(e):e}(e)}(p)},n.addFunction=function(e,n){if(i||(i=new WeakMap,function(e,n){for(var r=e;r<e+n;r++){var t=I(r);t&&i.set(t,r)}}(0,_.length)),i.has(e))return i.get(e);var r=function(){if(c.length)return c.pop();try{_.grow(1)}catch(e){if(!(e instanceof RangeError))throw e;throw"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH."}return _.length-1}();try{k(r,e)}catch(l){if(!(l instanceof TypeError))throw l;var t=function(e,n){if("function"==typeof WebAssembly.Function){for(var r={i:"i32",j:"i64",f:"f32",d:"f64"},t={parameters:[],results:"v"==n[0]?[]:[r[n[0]]]},l=1;l<n.length;++l)t.parameters.push(r[n[l]]);return new WebAssembly.Function(t,e)}var u=[1,0,1,96],a=n.slice(0,1),o=n.slice(1),i={i:127,j:126,f:125,d:124};for(u.push(o.length),l=0;l<o.length;++l)u.push(i[o[l]]);"v"==a?u.push(0):u=u.concat([1,i[a]]),u[1]=u.length-2;var s=new Uint8Array([0,97,115,109,1,0,0,0].concat(u,[2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0])),c=new WebAssembly.Module(s);return new WebAssembly.Instance(c,{e:{f:e}}).exports.f}(e,n);k(r,t)}return i.set(e,r),r},F=function e(){T||x(),T||(F=e)},n.run=x,x(),n.ready});let r,t;async function l(){r||(r={},r=await n(),t=r.HEAPU8,r._VMs={})}function u(){return r.ccall("wrenGetVersionNumber","number",[],[])}let a={COMPILE:0,RUNTIME:1,STACK_TRACE:2},o={SUCCESS:0,COMPILE_ERROR:1,RUNTIME_ERROR:2},i={BOOL:0,NUM:1,FOREIGN:2,LIST:3,MAP:4,NULL:5,STRING:6,UNKNOWN:7};class s{constructor(e){this.config=Object.assign({},m,e),this._ptr=r.ccall("shimNewVM","number",[],[]),r._VMs[this._ptr]=this,this._wb=""}get Module(){return r}get heap(){return t.buffer}_resolveModule(e,n){return this.config.resolveModuleFn(e,n)}_loadModule(e){let n=this.config.loadModuleFn(e);return n&&n.then?(n.then((n=>{null==n?this.interpret(e,`self__.transferError(${f(`Could not load module '${e}'`)})`):(this.interpret(e,n),this.interpret(e,"self__.transfer()"))}),(n=>{console.warn(`Error loading module source for "${e}"`,n),this.interpret(e,`self__.transferError(${f(String(n))})`)})),"var self__=Fiber.current\nFiber.suspend()\nself__=null"):n}_bindForeignMethod(e,n,t,l){let u=this.config.bindForeignMethodFn(e,n,t,l);return u?r.addFunction(u.bind(null,this),"vi"):0}_bindForeignClass(e,n,t){let l=this.config.bindForeignClassFn(e,n);if(l){let e=l.allocate,n=l.finalize,u=new Uint32Array(this.heap,t);e&&(u[0]=r.addFunction(e.bind(null,this),"vi")),n&&(u[1]=r.addFunction(n,"vi"))}}_write(e){let n,r=0;for(;(n=e.indexOf("\n",r))>=0;){let t=this._wb+e.slice(r,n);this._wb="",r=n+1,this.config.writeFn(t)}this._wb+=e.slice(r)}_error(e,n,r,t){this.config.errorFn(e,n,r,t)}free(){r.ccall("wrenFreeVM",null,["number"],[this._ptr]),delete r._VMs[this._ptr],this._ptr=void 0}collectGarbage(){r.ccall("wrenCollectGarbage",null,["number"],[this._ptr])}interpret(e,n){let t,l=0;"string"==typeof n?t="string":(l=r.stackSave(),n=c(n),t="number");let u=r.ccall("wrenInterpret","number",["number","string",t],[this._ptr,e,n]);return l&&r.stackRestore(l),u}makeCallHandle(e){return r.ccall("wrenMakeCallHandle","number",["number","string"],[this._ptr,e])}call(e){return r.ccall("wrenCall","number",["number","number"],[this._ptr,e])}releaseHandle(e){r.ccall("wrenReleaseHandle",null,["number","number"],[this._ptr,e])}getSlotCount(){return r.ccall("wrenGetSlotCount","number",["number"],[this._ptr])}ensureSlots(e){r.ccall("wrenEnsureSlots",null,["number","number"],[this._ptr,e])}getSlotType(e){return r.ccall("wrenGetSlotType","number",["number","number"],[this._ptr,e])}getSlotBool(e){return r.ccall("wrenGetSlotBool","boolean",["number","number"],[this._ptr,e])}getSlotBytes(e){let n=r.stackSave(),t=r.stackAlloc(4),l=r.ccall("wrenGetSlotBytes","number",["number","number","number"],[this._ptr,e,t]),u=new Int32Array(this.heap,t)[0];return r.stackRestore(n),new Uint8Array(this.heap,l,u)}getSlotDouble(e){return r.ccall("wrenGetSlotDouble","number",["number","number"],[this._ptr,e])}getSlotForeign(e){return r.ccall("wrenGetSlotForeign","number",["number","number"],[this._ptr,e])}getSlotString(e){return r.ccall("wrenGetSlotString","string",["number","number"],[this._ptr,e])}getSlotHandle(e){return r.ccall("wrenGetSlotHandle","number",["number","number"],[this._ptr,e])}setSlotBool(e,n){r.ccall("wrenSetSlotBool",null,["number","number","boolean"],[this._ptr,e,n])}setSlotBytes(e,n,t){null==t&&(t=n.byteLength),r.ccall("wrenSetSlotBytes",null,["number","number","number"==typeof n?"number":"array","number"],[this._ptr,e,n,t])}setSlotDouble(e,n){r.ccall("wrenSetSlotDouble",null,["number","number","number"],[this._ptr,e,n])}setSlotNewForeign(e,n,t){return r.ccall("wrenSetSlotNewForeign","number",["number","number","number","number"],[this._ptr,e,n,t])}setSlotNewList(e){r.ccall("wrenSetSlotNewList",null,["number","number"],[this._ptr,e])}setSlotNewMap(e){r.ccall("wrenSetSlotNewMap",null,["number","number"],[this._ptr,e])}setSlotNull(e){r.ccall("wrenSetSlotNull",null,["number","number"],[this._ptr,e])}setSlotString(e,n){let t,l=0;"string"==typeof n?t="string":(l=r.stackSave(),n=c(n),t="number"),r.ccall("wrenSetSlotString",null,["number","number",t],[this._ptr,e,n]),l&&r.stackRestore(l)}setSlotHandle(e,n){r.ccall("wrenSetSlotHandle",null,["number","number","number"],[this._ptr,e,n])}getListCount(e){return r.ccall("wrenGetListCount","number",["number","number"],[this._ptr,e])}getListElement(e,n,t){r.ccall("wrenGetListElement",null,["number","number","number","number"],[this._ptr,e,n,t])}setListElement(e,n,t){r.ccall("wrenSetListElement",null,["number","number","number","number"],[this._ptr,e,n,t])}insertInList(e,n,t){r.ccall("wrenInsertInList",null,["number","number","number","number"],[this._ptr,e,n,t])}getMapCount(e){return r.ccall("wrenGetMapCount","number",["number","number"],[this._ptr,e])}getMapContainsKey(e,n){return r.ccall("wrenGetMapContainsKey","boolean",["number","number","number"],[this._ptr,e,n])}getMapValue(e,n,t){r.ccall("wrenGetMapValue",null,["number","number","number","number"],[this._ptr,e,n,t])}setMapValue(e,n,t){r.ccall("wrenSetMapValue",null,["number","number","number","number"],[this._ptr,e,n,t])}removeMapValue(e,n,t){r.ccall("wrenRemoveMapValue",null,["number","number","number","number"],[this._ptr,e,n,t])}getVariable(e,n,t){r.ccall("wrenGetVariable",null,["number","string","string","number"],[this._ptr,e,n,t])}hasVariable(e,n){return r.ccall("wrenHasVariable","boolean",["number","string","string"],[this._ptr,e,n])}hasModule(e){return r.ccall("wrenHasModule","boolean",["number","string"],[this._ptr,e])}abortFiber(e){r.ccall("wrenAbortFiber",null,["number","number"],[this._ptr,e])}}function c(e){e instanceof ArrayBuffer&&(e=new Uint8Array(e));let n=0===e[e.length-1],l=n?e.length:e.length+1,u=r.stackAlloc(l);return t.set(e,u),n||(t[u+l-1]=0),u}function f(e){let n='"';for(let r=0;r<e.length;r++){let t=e[r];n+="\\"===t?"\\\\":"%"===t||'"'===t?"\\"+t:t}return n+'"'}let m={resolveModuleFn:function(e,n){return n},loadModuleFn:async function(e){return null},bindForeignMethodFn:function(e,n,r,t){return function(e){}},bindForeignClassFn:function(e,n){return null},writeFn:function(e){console.log("WREN: "+e)},errorFn:function(e,n,r,t){let l;0===e?l=`Compile Error [${n}:${r}]: ${t}`:1===e?l=`Error: ${t}`:2===e&&(l=`at ${t} ${n}:${r}`);return console.error("WREN: "+l),l}};var p={load:l,getVersionNumber:u,ErrorType:a,InterpretResult:o,Type:i,VM:s,defaultConfig:m};export{a as ErrorType,o as InterpretResult,i as Type,s as VM,p as default,m as defaultConfig,u as getVersionNumber,l as load};